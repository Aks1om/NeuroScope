from openai import OpenAI
import os

# SOCKS5 proxy
os.environ['HTTPS_PROXY'] = "socks5://MUqDrt:WS4Yx5@181.177.89.20:9826"

client = OpenAI(
    api_key="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"
)

# === Промпт для переписывания автоновости ===
prompt = (
    "Перепиши этот текст для моего Telegram-канала про автомобили. "
    "Сделай его коротким, дерзким и интересным, как будто пишет живой автолюбитель — добавь немного сарказма и эмоций. "
    "Тон должен быть уверенным и разговорным, с лёгким юмором (и даже негодованием, если уместно), но без лишнего молодёжного сленга — текст должен понравиться и молодым, и тем, кто постарше. "
    "Включи важные детали по теме, будто пишешь с экспертным знанием. Если в исходном посте упоминается фото или видео, отрази это в тексте с подходящим комментарием. "
    "Ограничение: итоговый пост должен быть максимально компактным — не длиннее 2–3 коротких абзацев. "
)

# === Сюда вставляй новость как текст ===
news_text = """
Ян Каллум, бывший главный дизайнер Jaguar Land Rover, а ныне владелец собственной компании по постройке эксклюзивных автомобилей, представил свой новый проект на базе культового Austin Mini.

Для проекта был взят Mini последней модификации MK5 Sports 2001 года. Его кузов полностью отреставрировали, установили бамперы и расширители колесных арок собственной конструкции, современную LED-светотехнику. Легкосплавные 13-дюймовые колесные диски в форме четырехлистного клевера были спроектированы Яном Каллумом лично.

В салоне установлена заново изготовленная передняя консоль в классическом стиле с современной мультимедиа с дисплеем и беспроводной связью, с мобильными устройствами и USB-розетками. Сиденья обиты кожей от шотландской компании Tan Bridge of Weir, поставщика Aston Martin и McLaren.

1,3-литровый двигатель Austin под капотом снабжен новой головкой блока с двумя форсунками на цилиндр и новым ЭБУ. В результате его мощность возросла вдвое, до 112 л.с. На автомобиль установлены тормозные механизмы с вентилируемыми дисками и новая подвеска шасси.

Компания Каллума готова строить такие Mini по индивидуальным заказам по стоимости от 75 тысяч фунтов (около 8 миллионов рублей). Владельцем первого экземпляра стал известный в узких кругах английский манекенщик Дэвид Ганди.
"""

completion = client.chat.completions.create(
    model="gpt-4.1",
    store=True,
    messages=[
        {"role": "system", "content": prompt},
        {"role": "user", "content": news_text}
    ]
)

print(f"\n{completion.choices[0].message.content}")

print(
    f"\nИспользовано токенов: {completion.usage.completion_tokens}\n"
    f"Кол-во токенов в промпте: {completion.usage.prompt_tokens}\n"
    f"Всего токенов: {completion.usage.total_tokens}"
)
